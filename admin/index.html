<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Admin</title>
    <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.1.5/angular.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/showdown/0.3.1/showdown.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/coffee-script/1.6.2/coffee-script.min.js"></script>
    <script type="text/coffeescript" src="app.coffee"></script>
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
</head>
<body ng-controller="Admin">
<div class="navbar navbar-inverse navbar-static-top">
    <div class="navbar-inner">
        <div class="brand">Create page</div> <!--TODO fix hover-->
        <ul class="nav">
            <li ng-repeat="(id, t) in templates">
                <a href="" ng-click="createPage(id)">
                    <i class="icon-white" ng-class="t.icon"></i> {{t.title}}
                </a>
            </li>
            <!--<li class="divider-vertical"></li>-->
        </ul>
        <ul class="nav pull-right">
            <li>
                <a href="{{logout_url}}">
                    <i class="icon-share icon-white"></i> Log Out
                </a>
            </li>
        </ul>
    </div>
</div>
<div class="container-fluid" style="padding-top:20px">
    <div class="row-fluid">
        <div class="sidebar-nav well well-small span3">
            <label>
                <input type="text" class="search-query" placeholder="Filter" ng-model="search.name">
            </label>
            <ul class="nav nav-list">
                <li ng-repeat="page in pages | filter:search">
                    <div class="row-fluid">
                        <div class="span6">
                            <i class="icon-black" ng-class="getIcon(page.template)"></i>
                            {{page.name}}
                        </div>
                        <div class="span6 btn-group pagination-right">
                            <button class="btn btn-mini btn-info" ng-click="get(page.id)">Edit</button>
                            <button class="btn btn-mini btn-danger" ng-click="delete(page.id)">Delete</button>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
        <div class="span9">
            <form name="form" class="well well-small" novalidate accept-charset="utf-8">
                <div class="row-fluid">
                    <div class="span2" style="min-width: 225px">
                        <label for="page_id"></label>
                        <input id="page_id" ng-model="page.id" placeholder="Page unique identifier" required />
                        <label for="page_name"></label>
                        <input id="page_name" ng-model="page.name" placeholder="Page name" required />
                        <label for="page_file"></label>
                        <input id="page_file" type="file" accept="image/*" onchange="file_obj = this.files[0]"/>
                    </div>
                    <div class="span9 pull-right">
                        <label for="page_content"></label>
                        <textarea id="page_content" ng-model="page.content" placeholder="Content" class="span12" rows="10">
                        </textarea>

                        <div class="btn-group pull-right">
                            <button class="btn btn-primary" ng-click="put()" ng-disabled="form.$invalid">Save</button>
                        </div>
                    </div>
                </div>
            </form>
            <div ng-bind-html-unsafe="converter.makeHtml(page.content || '')">
            </div>
        </div>
    </div>
</div>
</body>
</html>